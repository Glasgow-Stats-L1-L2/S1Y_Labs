[["index.html", "S1Y Lab 4 Welcome to Lab 4", " S1Y Lab 4 Welcome to Lab 4 Intended Learning Outcomes In this lab we investigate the ways in which sample statistics calculated from a random sample of data can serve as point estimates for population parameters. We're interested in formulating a sampling distribution of our point estimate in order to learn about the properties of the estimate, such as its shape, centre and spread. From that distribution we can calculate confidence intervals as interval estimates for the unknown population parameters. The material within this lab has been based on OpenLearn Chapter 5 OpenIntro Page 168. Feel free to refer back to the materials to help you with this lab. Credit where credit is due The labs in S1Y/Z are a derivative of the labs on the OpenIntro Statistics website by the OpenIntro team used under a Creative Commons Attribution-ShareAlike 4.0 International License. Some of the artwork used is by allison_horst "],["part-1---sampling-distributions.html", "Part 1 - Sampling Distributions Data Unknown Sampling Distribution Sample Size and Sampling Distribution Effect of Sample Size on Sampling Distribution", " Part 1 - Sampling Distributions Data A 2019 Gallup report states the following: The premise that scientific progress benefits people has been embodied in discoveries throughout the ages -- from the development of vaccinations to the explosion of technology in the past few decades, resulting in billions of supercomputers now resting in the hands and pockets of people worldwide. Still, not everyone around the world feels science benefits them personally. Source: World Science Day: Is Knowledge Power? The Wellcome Global Monitor report in 2018 finds that 20% of people globally do not believe that the work scientists do benefits people like them. (Though in positive news, the Wellcome Global Monitor report of 2020 found an increase in people's trust in scientists, most likely due to the impact of Covid-19). In this lab, we will assume this 20% is a true population proportion and learn about how sample proportions can vary from sample to sample by taking samples from the population. We will first create our population assuming a population size of 100,000 (which isn't very realistic, but it will serve the purposes of this lab). This means 20,000 (20%) of the population think the work scientists do does not benefit them personally and the remaining 80,000 think it does. The following piece of code creates the data frame for the responses of the population to the Global Monitor survey. global_monitor &lt;- tibble( scientist_work = c(rep(&quot;Benefits&quot;, 80000), rep(&quot;Doesn&#39;t benefit&quot;, 20000))) tibble is a function in tidyverse that creates a dataset, or \"data frame\" in R terminology. Within this data frame, the function rep(x, times) replicates the values in x times times. Here, we replicate \"Benefits\" 80000 times and \"Doesn't benefit\" 20000 times and coerced all in one vector, as 80% of the population think scientists work benefits them. The name of the data frame is global_monitor and the name of the variable that contains responses to the question \"Do you believe that the work scientists do benefit people like you?\" is scientist_work. What would this line of code return? c(rep(x, 1000), rep(y, 500)) vector of length 1000 all x vector of length 1500 with 1000 values of x and 500 values of y vector of length 500 all y matrix with 1000 rows of x and 500 columns of y Hint Think about what the rep function does to both components and then when they come together. Run the following R code to calculate the proportion of people who think that the work scientists do/don't benefit people like them to confirm we constructed the data frame correctly. global_monitor %&gt;% count(scientist_work) %&gt;% mutate(p = n /sum(n)) Run the following R code to produce a bar plot to visually demonstrate the distribution of the responses. ggplot(global_monitor, aes(x = scientist_work)) + geom_bar(fill = &quot;lightblue&quot;, width = 0.5) + labs(x = &quot;&quot;, y = &quot;&quot;, title = &quot;Population counts of beliefs in the work scientists do&quot;) + coord_flip() The function coord_flip flips the coordinates of the plot to create a horizontal bar plot. Unknown Sampling Distribution In this data set, we have access to the entire population of 100000 people, but this is almost never the case in real life. Gathering information on an entire population is often extremely costly or impossible. Because of this, we often take a sample of the population and use that to understand the properties of the population. If you are interested in estimating the proportion of people who don't think the work scientists do benefits them, you can use the sample_n command to survey the population. This following code collects a simple random sample of size 50 from the global_monitor data set, and assigns the result to sample1. sample1 &lt;- global_monitor %&gt;% sample_n(50) This is similar to randomly drawing names from a hat that contains the names of everyone in the population. Working with these 50 names is considerably simpler than working with all 100,000 people in the population. Exercise 1 Write code to produce the summary statistics and a bar plot for the results of the sample. Hint Although the sample_n function takes a random sample of observations (i.e. rows) from the data set, you can still refer to the variables in the dataset with the same names. Code presented earlier for visualising and summarising the population data will still be useful for the sample, however be careful to not label your proportion p since you're now calculating a sample statistic so use the label p_hat instead. Solution sample1 %&gt;% count(scientist_work) %&gt;% mutate(p_hat = n /sum(n)) ## # A tibble: 2 × 3 ## scientist_work n p_hat ## &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; ## 1 Benefits 39 0.78 ## 2 Doesn&#39;t benefit 11 0.22 ggplot(sample1, aes(x = scientist_work)) + geom_bar(fill = &quot;lightblue&quot;, width = 0.5) + labs(x = &quot;&quot;, y = &quot;&quot;, title = &quot;Do you believe that the work scientists do benefit people like you?&quot; ) + coord_flip() Think about how the proportions in your sample compare with the distribution of the population. Would you expect the sample distribution to be? Similar to the population distribution Very different to the population distribution Hint Think about the sample and the distribution it comes from, relate to materials within OpenLearn Section 5.1. If we're interested in estimating the proportion of all people who do not believe that the work scientists do benefits them, but we do not have access to the population data, our best single guess is the sample mean. We can calculate and display using the following code. sample1 %&gt;% count(scientist_work) %&gt;% mutate(p_hat = n /sum(n)) ## # A tibble: 2 × 3 ## scientist_work n p_hat ## &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; ## 1 Benefits 39 0.78 ## 2 Doesn&#39;t benefit 11 0.22 Depending on the 50 people selected, your estimate could be a bit above or a bit below the population proportion of 0.2. In general, though, the sample proportion turns out to be a pretty good estimate of the true population proportion, and you were able to get it by sampling less than 1% of the population, 50 out of 100000. Would you expect the sample proportion to match the sample proportion of another student's sample? Similar but not necessarily the same Completely different Exactly the same Hint As the sample is taken randomly from the population you would expect it to be slightly similar to other draws. Exercise 2 Take a second sample, also of size 50, and call it sample2. Compare the proportion of people who do not believe that the work scientists do benefits them in sample1 and sample2. Hint Create the sample from global_monitor using the function sample_n(). Calculate p_hat by using the functions count() and mutate(). Solution sample2 &lt;- global_monitor %&gt;% sample_n(50) sample2 %&gt;% count(scientist_work) %&gt;% mutate(p_hat = n /sum(n)) ## # A tibble: 2 × 3 ## scientist_work n p_hat ## &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; ## 1 Benefits 39 0.78 ## 2 Doesn&#39;t benefit 11 0.22 Create 2 more samples, of size 100 and 1000 calling them sample3 and sample4, and compare the proportion of people who do not believe that the work scientists do benefits them across all four samples. Hint sample3 and sample4, and their respective estimates of the population proportion p_hat, are created exactly the same way as sample1 and sample2, all that needs changed is the size of the sample within sample_n(). Solution sample3 &lt;- global_monitor %&gt;% sample_n(100) sample3 %&gt;% count(scientist_work) %&gt;% mutate(p_hat = n /sum(n)) ## # A tibble: 2 × 3 ## scientist_work n p_hat ## &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; ## 1 Benefits 77 0.77 ## 2 Doesn&#39;t benefit 23 0.23 sample4 &lt;- global_monitor %&gt;% sample_n(1000) sample4 %&gt;% count(scientist_work) %&gt;% mutate(p_hat = n /sum(n)) ## # A tibble: 2 × 3 ## scientist_work n p_hat ## &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; ## 1 Benefits 798 0.798 ## 2 Doesn&#39;t benefit 202 0.202 Looking at the new samples, of size 100 and 1000. Which would you think would provide a more precise estimate of the population mean? Sample size 50 Sample size 100 Sample size 1000 Hint Think about which sample contains the most information and therefore will be, on average, closer to the true population proportion. Not surprisingly, every time we take another random sample, you might get a different sample proportion. It's useful to get a sense of just how much variability in the sample proportions we should expect from sample to sample when estimating the population mean proportion in this way. The distribution of sample proportions, called the sampling distribution (of the proportion), can help us understand this variability. See Section 5.1.2 OpenIntro Page 181 Remember that in this lab we unusually had access to the population and therefore we can get an idea of the sampling distribution for the sample proportion by repeating the above steps many times. Here, we use the function rep_sample_n to take 15,000 different samples of size 50 from the population, calculate the proportion of Science doesn't benefit responses in each sample and store each result in a vector called sample_props50. The distribution of the proportions can then be visualised with a histogram. Note We specify that replace = TRUE since sampling distributions are constructed by sampling with replacement. Exercise 3 Run the following code to iterate 15000 samples of size 50 from the population. sample_props50 &lt;- global_monitor %&gt;% rep_sample_n(size = 50, reps = 15000, replace = TRUE) %&gt;% count(scientist_work) %&gt;% mutate(p_hat = n /sum(n)) %&gt;% filter(scientist_work == &quot;Doesn&#39;t benefit&quot;) ggplot(data = sample_props50, aes(x = p_hat)) + geom_histogram(binwidth = 0.05, fill = &quot;seagreen3&quot;) + labs(x = &quot;p_hat (Doesn&#39;t benefit)&quot;, title = &quot;Sampling distribution of p_hat&quot;, subtitle = &quot;Sample size = 50, Number of samples = 150&quot;) If you would like to adjust the bin width of your histogram to show a little more detail, you can do so by changing the binwidth argument in geom_histogram. How many elements are there in sample_props50? 50 100 1500 1000 15000 Hint Think about how many iterations were computed and how they are stored. What distribution does the shape of the histogram most resemble? Poisson Geometric Binomial Normal Hint Think about the shape of the histogram and the distributions you are familiar with. Exercise 4 Try changing the number of iterations carried out to see the effect this might have on the distribution. Start with 500 iterations and then increase. sample_props50 &lt;- global_monitor %&gt;% rep_sample_n(size = 50, reps = 500, replace = TRUE) %&gt;% count(scientist_work) %&gt;% mutate(p_hat = n /sum(n)) %&gt;% filter(scientist_work == &quot;Doesn&#39;t benefit&quot;) ggplot(data = sample_props50, aes(x = p_hat)) + geom_histogram(binwidth = 0.05, fill = &quot;seagreen3&quot;) + labs(x = &quot;p_hat (Doesn&#39;t benefit)&quot;, title = &quot;Sampling distribution of p_hat&quot;, subtitle = &quot;Sample size = 50&quot;) Would you expect the distribution to significantly change if 50,000 samples were collected? Yes No Hint Think about what more data would add to the overall shape. Try it out by changing the number of reps in the task above. Sample Size and Sampling Distribution Computing a sampling distribution, specifically, the sampling distribution of the proportions from samples of 50 people results in the following histogram. The sampling distribution that you computed tells you much about estimating the true proportion of people who think that the work scientists do doesn't benefit them. Because the sample proportion is an unbiased estimator, the sampling distribution is centered at the true population proportion, and the spread of the distribution indicates how much variability is incurred by sampling only 50 people at a time from the population. Effect of Sample Size on Sampling Distribution Now we will work on getting a sense of the effect that sample size has on the sampling distribution. Exercise 5 Try changing the sample size to see the effect this might have on the distribution. Start with a sample size of 50 and then increase it to see the effect (e.g. double it, then double it again). sample_props &lt;- global_monitor %&gt;% rep_sample_n(size = 50, reps = 15000, replace = TRUE) %&gt;% count(scientist_work) %&gt;% mutate(p_hat = n /sum(n)) %&gt;% filter(scientist_work == &quot;Doesn&#39;t benefit&quot;) ggplot(data = sample_props, aes(x = p_hat)) + geom_histogram(binwidth = 0.02, fill = &quot;seagreen3&quot;) + xlim(0, 1) + labs(x = &quot;p_hat (Doesn&#39;t benefit)&quot;, title = &quot;Sampling distribution of p_hat&quot;, subtitle = &quot;Trying different sample sizes&quot;) Hint Run the code as it is to see the results for n = 50 then change this value of 50 to 100 i.e. rep_sample_n(size = 100) then run the code. Repeat for n = 200 Solution sample_props &lt;- global_monitor %&gt;% rep_sample_n(size = 100, reps = 15000, replace = TRUE) %&gt;% count(scientist_work) %&gt;% mutate(p_hat = n /sum(n)) %&gt;% filter(scientist_work == &quot;Doesn&#39;t benefit&quot;) ggplot(data = sample_props, aes(x = p_hat)) + geom_histogram(binwidth = 0.02, fill = &quot;seagreen3&quot;) + xlim(0, 1) + labs(x = &quot;p_hat (Doesn&#39;t benefit)&quot;, title = &quot;Sampling distribution of p_hat&quot;, subtitle = &quot;Trying different sample sizes (n=100 here)&quot;) sample_props &lt;- global_monitor %&gt;% rep_sample_n(size = 200, reps = 15000, replace = TRUE) %&gt;% count(scientist_work) %&gt;% mutate(p_hat = n /sum(n)) %&gt;% filter(scientist_work == &quot;Doesn&#39;t benefit&quot;) ggplot(data = sample_props, aes(x = p_hat)) + geom_histogram(binwidth = 0.02, fill = &quot;seagreen3&quot;) + xlim(0, 1) + labs(x = &quot;p_hat (Doesn&#39;t benefit)&quot;, title = &quot;Sampling distribution of p_hat&quot;, subtitle = &quot;Trying different sample sizes (n=200 here)&quot;) When the sample size is larger, what happens to the center? Increases Decreases Stays constant Hint Try increasing the sample size value above and try various values to see the change in histogram. When the sample size is larger, what happens to the spread? Increases Decreases Stays constant Hint Try increasing the sample size value above and try various values to see the change in histogram. "],["part-2---confidence-intervals.html", "Part 2 - Confidence Intervals Data Computing Confidence Intervals Confidence Levels", " Part 2 - Confidence Intervals Data A 2019 Pew Research report states the following: Roughly six-in-ten U.S. adults (62%) say climate change is currently affecting their local community either a great deal or some, according to a new Pew Research Center survey. Source: Most Americans say climate change impacts their community, but effects vary by region In this part of the lab, we will assume this 62% is a true population proportion and learn about how sample proportions can vary from sample to sample by taking smaller samples from the population. We will first create our population assuming a population size of 100,000 (which is unrealistic, but it keeps the computing time down to a reasonable level for this lab). This means 62,000 (62%) of the adult population think climate change impacts their community, and the remaining 38,000 do not think so. We used the code below to construct the data frame for this problem. The data frame is constructed as before using the tibble function; (refer to the start of this lab to understand what the code is doing). us_adults &lt;- tibble( climate_change_affects = c(rep(&quot;Yes&quot;, 62000), rep(&quot;No&quot;, 38000))) The name of the data frame is us_adults and the name of the variable that contains responses to the question \"Do you think climate change is affecting your local community?\" is climate_change_affects. Similar to before, run the following code to obtain summary statistics to confirm we constructed the data frame correctly and to visualise the distribution of these responses using a bar plot. Exercise 6 Using the code seen earlier in the lab, write code to produce summary statistics and produce a plot of the data showing how many people think climate change is affecting their local community and those who do not. Hint Calculate the proportion of people who think climate change is affecting their local community p using count and mutate. Then create a barplot using geom_bar. Solution us_adults %&gt;% count(climate_change_affects) %&gt;% mutate(p = n /sum(n)) ## # A tibble: 2 × 3 ## climate_change_affects n p ## &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; ## 1 No 38000 0.38 ## 2 Yes 62000 0.62 ggplot(us_adults, aes(x = climate_change_affects)) + geom_bar(fill = &quot;lightblue&quot;, width = 0.5) + labs(x = &quot;&quot;, y = &quot;&quot;, title = &quot;Do you think climate change is affecting your local community?&quot; ) + coord_flip() We'll start with a simple random sample of size 60 from the population. Exercise 7 Create a sample of size 60 from the data and compute the percent of the adults in the sample think climate change affects their local community? Hint Think about using code from earlier in the lab. Use sample_n() to draw a sample of size 60 and then calculate p_hat using count and mutate. Solution sample &lt;- us_adults %&gt;% sample_n(60) sample %&gt;% count(climate_change_affects) %&gt;% mutate(p_hat = n /sum(n)) ## # A tibble: 2 × 3 ## climate_change_affects n p_hat ## &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; ## 1 No 22 0.367 ## 2 Yes 38 0.633 What would you expect another student's proportion to be? Identical Very different Slightly similar Hint Think about multiple samples taken from the same population, refer to materials in OpenLearn Section 5.2 to help. Computing Confidence Intervals Returning to the motivation for this lab: based on this sample, what can you infer about the population? With just one sample, the best estimate of the proportion of US adults who think climate change affects their local community would be the sample proportion, usually denoted as \\(\\hat{p}\\) (here we are calling it p_hat). That serves as a good point estimate, but it would be useful to also communicate how uncertain we are of that estimate. This uncertainty can be quantified using a confidence interval, which is an example of an interval estimate. See Section 5.2 Page 181-183 OpenIntro Page 181 Remembering that the standard error (SE) of a point estimate is the same as the standard deviation of the point estimate, we calculate a 95% confidence interval for a sample proportion by adding and subtracting 1.96 \\(\\times\\) standard error (SE) to the point estimate. \\[ \\hat{p} \\pm 1.96 * SE \\] Or simply in R using: se &lt;- sd(sample) / sqrt(n) lower &lt;- p_hat - 1.96 * SE upper &lt;- p_hat + 1.96 * SE c(lower, upper) This is an important inference that we've just made: even though we don't know what the full population looks like, we're 95% confident that the true population proportion lies between the lower and upper values. However, some conditions need to be made for the confidence interval to be valid. What conditions must be met for this confidence to be valid? The distribution is skewed but it is allowed with a small sample size Data comes from a binomial distribution Independence assumption is valid Data comes from a normal distribution The disribution is skewed but it is allowed with a large sample size Hint Think about the conditions the Central Limit Theorem needs to allow the interval to be computed as seen in OpenLearn Section 5.2. Confidence Levels In the last section, we used the phrase \"95% confident\" - but what does this mean? In this case we have the luxury of knowing the true population proportion since we constructed the data on the entire population. Run the following code to create a confidence interval from a sample of size 60. sample &lt;- us_adults %&gt;% sample_n(60) sample_pro &lt;- proportions(table(sample)) sample_pro &lt;- sample_pro[2] sample_se &lt;- sqrt(sample_pro * (1 - sample_pro) / 60) lower_vector &lt;- sample_pro - 1.96 * sample_se upper_vector &lt;- sample_pro + 1.96 * sample_se ci &lt;- c(lower_vector, upper_vector) ci If you were to repeat this simulation again and again, would each confidence interval capture the true population proportion of US adults who think climate change affects their local community? Each would with 95% confidence Yes, each certainly would No, each certainly wouldn't Hint Think about what the interval is estimating and with what level of confidence. If we were to collect all the confidence intervals produced in the console above by all the students in S1Y, each student should have produced a slightly different confidence interval because they were each based on different random samples. What proportion of those intervals would you expect to capture the true population mean? 5% 95% 2.5% Hint Think about what repeatedly sampling would do to the interval and the confidence it produces. We will now collect many samples to learn more about how sample proportions and confidence intervals constructed based on those samples vary from one sample to another. This will be done by: Obtain a random sample. Calculate the sample proportion, and use these to calculate and store the lower and upper bounds of the confidence intervals. Repeat these steps for a large number of times. Exercise 8 Run the code below and change the sample size and confidence level. This will show the effect these factors have on the confidence intervals. When running this code consider the true population proportion and if the intervals contain this value. Note The confidence level we have been using is 95% which refers to 1.96 within the code. This is used as 95% of the area of a normal distribution is within 1.96 standard deviations of the mean, as seen on OpenIntro Page 183. Other confidence levels can be used but commonly: 99% uses \\(\\pm\\) 2.58, 97% uses \\(\\pm\\) 2.17, 95% uses \\(\\pm\\) 1.96, 90% uses \\(\\pm\\) 1.64, 75% uses \\(\\pm\\) 0.67. n &lt;- 60 sample &lt;- us_adults %&gt;% sample_n(n) sample_pro &lt;- proportions(table(sample)) sample_pro &lt;- sample_pro[2] sample_se &lt;- sqrt(sample_pro * (1 - sample_pro) / n) #90% Confidence Level lower_vector &lt;- sample_pro - 1.64* sample_se upper_vector &lt;- sample_pro + 1.64 * sample_se ci &lt;- c(lower_vector, upper_vector) c(&quot;90% CI&quot;, paste(round(ci,3))) #95% Confidence Level lower_vector &lt;- sample_pro - 1.96 * sample_se upper_vector &lt;- sample_pro + 1.96 * sample_se ci &lt;- c(lower_vector, upper_vector) c(&quot;95% CI&quot;, paste(round(ci,3))) #99% Confidence Level lower_vector &lt;- sample_pro - 2.58 * sample_se upper_vector &lt;- sample_pro + 2.58 * sample_se ci &lt;- c(lower_vector, upper_vector) c(&quot;99% CI&quot;, paste(round(ci,3))) Which interval would you expect to be wider? Interval with a larger confidence level Interval with a larger sample size Hide Increasing the sample size decreases the width of the confidence interval, this is because it decreases the standard error reducing the variability of the interval. "],["group-tasks.html", "Group Tasks Sampling Distributions Confidence Intervals", " Group Tasks Sampling Distributions In Part 1, we have only focused on estimating the proportion of those who think the work scientists do doesn’t benefit them. Now, you’ll try to estimate the proportion of those who think the work of scientists does benefit them. Task 1 Take a sample of size 20 from the population and calculate the proportion of people in this sample who think the work scientists do enhances their lives. Using this sample, state the point estimate of the population proportion of people who think the work scientists do enhance their lives? Task 2 Take 2000 samples of size 20 from the population and compute 2000 sample proportions for those who think the work scientists do enhance their lives. Store these proportions as sample_props20. Plot the data as a histogram. Is there any skew in this sampling distribution? Yes, the data are left skewed Yes, the data are right skewed No, there is no skew present Task 3 Change your sample size from 20 to 200 and calculate each sample proportion using the same method as above. Store these proportions in a new object called sample_props200. Then, plot the sampling distribution as a histogram. What value would you use to estimate the true population proportion from the sampling distribution from Task 3? The median of the sample proportions The mean of the sample proportions The maximum of the sample proportions The minimum of the sample proportions Of the sampling distributions from 2 and 3, which has a smaller spread? Sampling distribution from Q2 Sampling distribution from Q3 Confidence Intervals For a confidence level of 90%, what is the appropriate critical value? (to 2 decimal places) Task 4 Take a sample of size 60 from us_adults and find a confidence interval for the proportion of US Adults who think climate change is affecting their local community with a confidence level of 90% and interpret it. Is this interval narrower or wider than the confidence interval for the proportion of US Adults who think climate change is affecting their local community calculated earlier at a 95% confidence level? narrower wider "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
