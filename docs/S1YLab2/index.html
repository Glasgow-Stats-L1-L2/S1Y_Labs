<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>S1Y Lab 2</title>
  <meta name="description" content="S1Y Lab 2" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="S1Y Lab 2" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="S1Y Lab 2" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  

<link rel="next" href="group-exercises.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="include/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Visualizing Data</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#intended-learning-outcomes"><i class="fa fa-check"></i><b>1.1</b> Intended Learning Outcomes</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#visualising-data-great-british-bake-off-gbbo"><i class="fa fa-check"></i><b>1.2</b> Visualising Data: Great British Bake Off (GBBO)</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#reading-data-in"><i class="fa fa-check"></i><b>1.2.1</b> Reading data in</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#building-plots"><i class="fa fa-check"></i><b>1.3</b> Building plots</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#counting-categories"><i class="fa fa-check"></i><b>1.4</b> Counting categories</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#bar-plot"><i class="fa fa-check"></i><b>1.4.1</b> Bar plot</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#column-plot"><i class="fa fa-check"></i><b>1.4.2</b> Column plot</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#test-your-understanding"><i class="fa fa-check"></i><b>1.4.3</b> <strong>Test your understanding</strong></a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#one-numerical-variable"><i class="fa fa-check"></i><b>1.5</b> One numerical variable</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#histogram"><i class="fa fa-check"></i><b>1.5.1</b> Histogram</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#grouped-numerical-variables"><i class="fa fa-check"></i><b>1.6</b> Grouped numerical variables</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="index.html"><a href="index.html#subdividing-distributions"><i class="fa fa-check"></i><b>1.6.1</b> Subdividing distributions</a></li>
<li class="chapter" data-level="1.6.2" data-path="index.html"><a href="index.html#violin-plot"><i class="fa fa-check"></i><b>1.6.2</b> Violin plot</a></li>
<li class="chapter" data-level="1.6.3" data-path="index.html"><a href="index.html#boxplot"><i class="fa fa-check"></i><b>1.6.3</b> Boxplot</a></li>
<li class="chapter" data-level="1.6.4" data-path="index.html"><a href="index.html#test-your-understanding-1"><i class="fa fa-check"></i><b>1.6.4</b> Test your understanding</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#two-numerical-variables"><i class="fa fa-check"></i><b>1.7</b> Two numerical variables</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="index.html"><a href="index.html#scatterplot"><i class="fa fa-check"></i><b>1.7.1</b> Scatterplot</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#two-numerical-variables-and-a-categorical-variable"><i class="fa fa-check"></i><b>1.8</b> Two numerical variables and a categorical variable</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="group-exercises.html"><a href="group-exercises.html"><i class="fa fa-check"></i><b>2</b> Group Exercises</a>
<ul>
<li class="chapter" data-level="2.1" data-path="group-exercises.html"><a href="group-exercises.html#bfrss-survey-questions"><i class="fa fa-check"></i><b>2.1</b> BFRSS Survey Questions</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">S1Y Lab 2</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">S1Y Lab 2</h1>
</div>
<div id="visualizing-data" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">1</span> Visualizing Data<a href="index.html#visualizing-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="intended-learning-outcomes" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> Intended Learning Outcomes<a href="index.html#intended-learning-outcomes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Be able to create graphical summaries of data using the <code>ggplot2</code> library</li>
</ul>
</div>
<div id="visualising-data-great-british-bake-off-gbbo" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> Visualising Data: Great British Bake Off (GBBO)<a href="index.html#visualising-data-great-british-bake-off-gbbo" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="images/GBBO_1.png" width="50%" /></p>
<p>In this lab, we will revisit the Great British Bake Off dataset which we worked with in Lab 1. Refer to Lab 1 for a reminder of the dataset structure if you need to.</p>
<div id="reading-data-in" class="section level3 hasAnchor" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> Reading data in<a href="index.html#reading-data-in" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The file <code>ratings_seasons_Lab2.csv</code> contains data on the first 10 series (2010-2019) and includes all the additional variables we created in Lab 1. You can load the data in like Lab 1 below:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="index.html#cb1-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="index.html#cb1-2" tabindex="-1"></a>ratings <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/Glasgow-Stats-L1-L2/S1Y_Data/main/ratings_seasons.csv&quot;</span>)</span></code></pre></div>
<p>We can also read the <code>ratings_seasons.csv</code> file in locally to RStudio if we download a copy of the file onto our own device. You can find this file in the 'Lab 1' section on Moodle.</p>
<p>Once you have downloaded and saved the csv file to your device (it is usually a good idea to save data in the same place as your R script), we will then have to set the working directory (where your file is located).</p>
<p>In order to do this go to:</p>
<ul>
<li>Session &gt; Set Working Directory &gt; Choose Directory...</li>
</ul>
<p>The file explorer will then open, and you can locate the folder your data is stored in. Once this has been found, select 'Open".</p>
<p>Once our working directory has been set, we now have to read our data into RStudio. We can do this using the following command</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="index.html#cb2-1" tabindex="-1"></a>ratings <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;ratings_seasons_Lab2.csv&#39;</span>)</span></code></pre></div>
<p>We will once again have to change the variables <code>series</code>, <code>episode</code> and <code>channel</code> to factors which we can do using the code below.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="index.html#cb3-1" tabindex="-1"></a>ratings <span class="ot">&lt;-</span> ratings <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="index.html#cb3-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">series =</span> <span class="fu">as.factor</span>(series),</span>
<span id="cb3-3"><a href="index.html#cb3-3" tabindex="-1"></a>         <span class="at">episode =</span> <span class="fu">as.factor</span>(episode),</span>
<span id="cb3-4"><a href="index.html#cb3-4" tabindex="-1"></a>         <span class="at">channel =</span> <span class="fu">as.factor</span>(channel))</span></code></pre></div>
</div>
</div>
<div id="building-plots" class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> Building plots<a href="index.html#building-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are multiple approaches to data visualisation in R; in this course we will use the popular package <code>ggplot2</code>, which is part of the larger <code>tidyverse</code> collection of packages. A grammar of graphics (the "gg" in "ggplot") is a standardised way to describe the components of a graphic. <code>ggplot2</code> uses a layered grammar of graphics, in which plots are built up in a series of layers. It may be helpful to think about any picture as having multiple elements that sit semi-transparently over each other.</p>
<p>Figure 1 displays the steps to create a simple scatterplot using this layered approach. First, the plot space is built (layer 1); the variables are specified (layer 2); the type of visualisation (known as a geom) that is desired for these variables is specified (layer 3) - in this case geom_point() is called to visualise individual data points; a second geom is added to include a line of best fit (layer 4), the axis labels are edited for readability (layer 5), and finally, a theme is applied to change the overall appearance of the plot (layer 6).</p>
<div class="figure"><span style="display:block;" id="fig:img-layers"></span>
<img src="images/plot_layers.png" alt="Steps to create a layered plot" width="504" />
<p class="caption">
Figure 1.1: Steps to create a layered plot
</p>
</div>
<p>Importantly, each layer is independent and independently customisable. For example, the size, colour and position of each component can be adjusted. The use of layers makes it easy to build up complex plots step-by-step, and to adapt or extend plots from existing code.</p>
<p>Using the concept of building up a plot by layers, we will describe some specific plot types. Different types of data require different types of plots, so the following sections are organised by data type.</p>
<p>The <code>ggplot2</code> <a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-visualization.pdf">cheat sheet</a> is a great resource to help you find plots appropriate to your data, based on how many variables you're plotting and what type they are. The examples below all use the GBBO data, but each plot communicates something different.</p>
<p>We don't expect you to memorise all of the plot types or the methods for customising them, but it will be helpful to try out the code in the examples below for yourself, changing values to test your understanding.</p>
</div>
<div id="counting-categories" class="section level2 hasAnchor" number="1.4">
<h2><span class="header-section-number">1.4</span> Counting categories<a href="index.html#counting-categories" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="bar-plot" class="section level3 hasAnchor" number="1.4.1">
<h3><span class="header-section-number">1.4.1</span> Bar plot<a href="index.html#bar-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you want to count the number of things per category, you can use <code>geom_bar()</code>. You only need to provide an x mapping to <code>geom_bar()</code> because by default <code>geom_bar()</code> uses the number of observations in each group of x as the value for y, so you don't need to tell it what to put on the y-axis.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="index.html#cb4-1" tabindex="-1"></a><span class="fu">ggplot</span>(ratings, <span class="fu">aes</span>(<span class="at">x =</span> channel)) <span class="sc">+</span></span>
<span id="cb4-2"><a href="index.html#cb4-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Notice that layers are added using the plus <code>+</code> symbol at the end of the previous line, not at the start of the next line. For example if you make this mistake:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="index.html#cb5-1" tabindex="-1"></a><span class="fu">ggplot</span>(ratings, <span class="fu">aes</span>(<span class="at">x =</span> channel))</span>
<span id="cb5-2"><a href="index.html#cb5-2" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>()</span></code></pre></div>
<p>...it will produce an empty 'base layer' and then an error like this:</p>
<p><img src="main_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre><code>## Error:
## ! Cannot use `+` with a single argument
## ℹ Did you accidentally put `+` on a new line?</code></pre>
<p> 
 </p>
<ul>
<li><strong>Inspect the code below and try running it layer by layer to figure out how things like the order of the columns and their labels change.</strong></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="index.html#cb7-1" tabindex="-1"></a><span class="fu">ggplot</span>(ratings, <span class="fu">aes</span>(<span class="at">x =</span> channel, </span>
<span id="cb7-2"><a href="index.html#cb7-2" tabindex="-1"></a>                <span class="at">fill =</span> channel)) <span class="sc">+</span></span>
<span id="cb7-3"><a href="index.html#cb7-3" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb7-4"><a href="index.html#cb7-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Number of episodes of GBBO broadcast on each channel&quot;</span>)<span class="sc">+</span> <span class="co"># adds a plot title</span></span>
<span id="cb7-5"><a href="index.html#cb7-5" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Number of Episodes&quot;</span>)<span class="sc">+</span> <span class="co"># adds an axis label</span></span>
<span id="cb7-6"><a href="index.html#cb7-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span> <span class="co"># removes the legend</span></span>
<span id="cb7-7"><a href="index.html#cb7-7" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb7-8"><a href="index.html#cb7-8" tabindex="-1"></a>    <span class="co"># change axis label</span></span>
<span id="cb7-9"><a href="index.html#cb7-9" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Broadcast Channels (in chronological order)&quot;</span>, </span>
<span id="cb7-10"><a href="index.html#cb7-10" tabindex="-1"></a>    <span class="co"># change to chronological order</span></span>
<span id="cb7-11"><a href="index.html#cb7-11" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="st">&quot;BBC2&quot;</span>, <span class="st">&quot;BBC1&quot;</span>, <span class="st">&quot;C4&quot;</span>), </span>
<span id="cb7-12"><a href="index.html#cb7-12" tabindex="-1"></a>    <span class="co"># change labels</span></span>
<span id="cb7-13"><a href="index.html#cb7-13" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;BBC 2&quot;</span>, <span class="st">&quot;BBC 1&quot;</span>, <span class="st">&quot;Channel 4&quot;</span>)</span>
<span id="cb7-14"><a href="index.html#cb7-14" tabindex="-1"></a>    )</span></code></pre></div>
<p><img src="main_files/figure-html/custom-bar-1.png" width="672" /></p>
<p> </p>
<ul>
<li><strong>Copy and edit the code above to produce a bar plot showing the number of episodes in each series of GBBO</strong></li>
</ul>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="index.html#cb8-1" tabindex="-1"></a><span class="fu">ggplot</span>(ratings, <span class="fu">aes</span>(<span class="at">x =</span> series, </span>
<span id="cb8-2"><a href="index.html#cb8-2" tabindex="-1"></a>                <span class="at">fill =</span> series)) <span class="sc">+</span></span>
<span id="cb8-3"><a href="index.html#cb8-3" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb8-4"><a href="index.html#cb8-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Number of episodes of GBBO broadcast in each series&quot;</span>)<span class="sc">+</span>  <span class="co"># adds a plot title</span></span>
<span id="cb8-5"><a href="index.html#cb8-5" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Number of Episodes&quot;</span>)<span class="sc">+</span>      <span class="co"># adds an axis label</span></span>
<span id="cb8-6"><a href="index.html#cb8-6" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Series&quot;</span>)<span class="sc">+</span>                  <span class="co"># adds an axis label</span></span>
<span id="cb8-7"><a href="index.html#cb8-7" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span> <span class="co"># removes the legend</span></span>
<span id="cb8-8"><a href="index.html#cb8-8" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb8-9"><a href="index.html#cb8-9" tabindex="-1"></a>    <span class="co"># change to categorical labels</span></span>
<span id="cb8-10"><a href="index.html#cb8-10" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;5&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;7&quot;</span>, <span class="st">&quot;8&quot;</span>, <span class="st">&quot;9&quot;</span>, <span class="st">&quot;10&quot;</span>), </span>
<span id="cb8-11"><a href="index.html#cb8-11" tabindex="-1"></a>    <span class="co"># change labels</span></span>
<span id="cb8-12"><a href="index.html#cb8-12" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;5&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;7&quot;</span>, <span class="st">&quot;8&quot;</span>, <span class="st">&quot;9&quot;</span>, <span class="st">&quot;10&quot;</span>)</span>
<span id="cb8-13"><a href="index.html#cb8-13" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="main_files/figure-html/ex-bar-1.png" width="672" /></p>
</div>
</div>
<div id="column-plot" class="section level3 hasAnchor" number="1.4.2">
<h3><span class="header-section-number">1.4.2</span> Column plot<a href="index.html#column-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If your data already have a column with the number you want to be the height of each bar or column, you can use <code>geom_col()</code> to plot it. Recall that the <code>ratings</code> data contains the variable <code>viewers_7day</code> which contains the number of viewers in the 7 days after each episode which we can plot as the height of each bar/column by setting <code>y=viewers_7day</code>. But what will we use to define where they are plotted on the x-axis?</p>
<ul>
<li><p><strong>After considering the values contained in the variable <code>series</code> and/or <code>episode</code> complete this statement:</strong></p>
<p><strong>Neither the values in <code>series</code> or <code>episode</code> can be used to define <code>x=</code>:</strong> <select class='webex-select'><option value='blank'></option><option value='answer'>TRUE</option><option value=''>FALSE</option></select></p></li>
</ul>
<div class="webex-solution">
<button>
Explanation
</button>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="index.html#cb9-1" tabindex="-1"></a><span class="fu">select</span>(ratings,series,episode)</span></code></pre></div>
<pre><code>## # A tibble: 94 × 2
##    series episode
##    &lt;fct&gt;  &lt;fct&gt;  
##  1 1      1      
##  2 1      2      
##  3 1      3      
##  4 1      4      
##  5 1      5      
##  6 1      6      
##  7 2      1      
##  8 2      2      
##  9 2      3      
## 10 2      4      
## # ℹ 84 more rows</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="index.html#cb11-1" tabindex="-1"></a><span class="co"># Notice that neither series nor episode contain unique values, which would be necessary to define the position on the x-axis for each of the columns with height equal to the ratings (viewers_7day)</span></span></code></pre></div>
</div>
<p>So before we can create the column plot, we need to create a new variable:</p>
<ul>
<li><strong>Run this code to create a new variable <code>ep_id</code> which is the unique index indicating the chronological order of each episode (using the <code>row_number()</code> function and the fact that it's the same as the order it appears in the <code>ratings</code> data).</strong></li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="index.html#cb12-1" tabindex="-1"></a>ratings <span class="ot">&lt;-</span> ratings <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">ep_id =</span> <span class="fu">row_number</span>())</span></code></pre></div>
<p>Now we have the two variables we need to make the column plot.</p>
<ul>
<li><strong>Inspect and run this code to produce the plot below.</strong></li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="index.html#cb13-1" tabindex="-1"></a><span class="fu">ggplot</span>(ratings, <span class="fu">aes</span>(<span class="at">x =</span> ep_id, <span class="at">y =</span> viewers_7day, <span class="at">fill =</span> series)) <span class="sc">+</span></span>
<span id="cb13-2"><a href="index.html#cb13-2" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb13-3"><a href="index.html#cb13-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;7-Day Viewers across All Series/Episodes&quot;</span>)<span class="sc">+</span></span>
<span id="cb13-4"><a href="index.html#cb13-4" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Number of viewers (millions)&quot;</span>)<span class="sc">+</span>      <span class="co"># adds an axis label</span></span>
<span id="cb13-5"><a href="index.html#cb13-5" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Episode Index&quot;</span>)<span class="sc">+</span>                     <span class="co"># adds an axis label</span></span>
<span id="cb13-6"><a href="index.html#cb13-6" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">name=</span><span class="st">&quot;Series&quot;</span>)         <span class="co"># set the name of the legend  </span></span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="test-your-understanding" class="section level3 hasAnchor" number="1.4.3">
<h3><span class="header-section-number">1.4.3</span> <strong>Test your understanding</strong><a href="index.html#test-your-understanding" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here is a small data table.</p>
<table>
<thead>
<tr class="header">
<th align="left">country</th>
<th align="right">population</th>
<th align="left">island</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Northern Ireland</td>
<td align="right">1,895,510</td>
<td align="left">Ireland</td>
</tr>
<tr class="even">
<td align="left">Wales</td>
<td align="right">3,169,586</td>
<td align="left">Great Britain</td>
</tr>
<tr class="odd">
<td align="left">Republic of Ireland</td>
<td align="right">4,937,786</td>
<td align="left">Ireland</td>
</tr>
<tr class="even">
<td align="left">Scotland</td>
<td align="right">5,466,000</td>
<td align="left">Great Britain</td>
</tr>
<tr class="odd">
<td align="left">England</td>
<td align="right">56,550,138</td>
<td align="left">Great Britain</td>
</tr>
</tbody>
</table>
<ul>
<li>What geom would you use to plot the population for each of the 5 countries? <select class='webex-select'><option value='blank'></option><option value='x'>geom_bar</option><option value='answer'>geom_col</option></select></li>
<li>What mapping would you use?
<div id="radio_UYYTPHCOQW" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_UYYTPHCOQW" value="answer"></input> <span>aes(x = country, y = population)</span></label><label><input type="radio" autocomplete="off" name="radio_UYYTPHCOQW" value="x"></input> <span>aes(x = population, y = country)</span></label><label><input type="radio" autocomplete="off" name="radio_UYYTPHCOQW" value="x"></input> <span>aes(x = country)</span></label><label><input type="radio" autocomplete="off" name="radio_UYYTPHCOQW" value="x"></input> <span>aes(x = island)</span></label><label><input type="radio" autocomplete="off" name="radio_UYYTPHCOQW" value="x"></input> <span>aes(y = population)</span></label>
</div></li>
<li>What geom would you use to plot the number of countries on each island? <select class='webex-select'><option value='blank'></option><option value='answer'>geom_bar</option><option value='x'>geom_col</option></select></li>
<li>What mapping would you use?
<div id="radio_GHOWLEIXBB" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_GHOWLEIXBB" value="x"></input> <span>aes(x = country, y = population)</span></label><label><input type="radio" autocomplete="off" name="radio_GHOWLEIXBB" value="x"></input> <span>aes(x = population, y = country)</span></label><label><input type="radio" autocomplete="off" name="radio_GHOWLEIXBB" value="x"></input> <span>aes(x = country)</span></label><label><input type="radio" autocomplete="off" name="radio_GHOWLEIXBB" value="answer"></input> <span>aes(x = island)</span></label><label><input type="radio" autocomplete="off" name="radio_GHOWLEIXBB" value="x"></input> <span>aes(y = population)</span></label>
</div></li>
</ul>
</div>
</div>
<div id="one-numerical-variable" class="section level2 hasAnchor" number="1.5">
<h2><span class="header-section-number">1.5</span> One numerical variable<a href="index.html#one-numerical-variable" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you have a numerical variable, like the number of views 7 days after each broadcast, you can use <code>geom_histogram()</code> or <code>geom_density()</code> to show the distribution. Just like <code>geom_bar()</code> you are only required to specify the <code>x</code> variable.</p>
<div id="histogram" class="section level3 hasAnchor" number="1.5.1">
<h3><span class="header-section-number">1.5.1</span> Histogram<a href="index.html#histogram" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A histogram splits the data into "bins" along the x-axis and shows the count of how many observations are in each bin along the y-axis.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="index.html#cb14-1" tabindex="-1"></a><span class="fu">ggplot</span>(ratings, <span class="fu">aes</span>(<span class="at">x =</span> viewers_7day)) <span class="sc">+</span></span>
<span id="cb14-2"><a href="index.html#cb14-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-11"></span>
<img src="main_files/figure-html/unnamed-chunk-11-1.png" alt="Histogram of ratings." width="672" />
<p class="caption">
Figure 1.2: Histogram of ratings.
</p>
</div>
<!-- By default, the bars start *centered* on 0, so if `binwidth` is set to 15, the first bar would include -7.5 to 7.5 seconds, which doesn't make much sense. We can set `boundary = 0` so that each bar represents increments of 15 seconds *starting* from 0.  -->
<!-- ```{r} -->
<!-- ggplot(ratings, aes(x = viewers_7day)) + -->
<!--   geom_histogram(boundary = 0) -->
<!-- ``` -->
<p>You should always set the <code>binwidth</code> or number of <code>bins</code> to something meaningful for your data (otherwise you get an annoying message, like the one above). You might need to try a few options before you find something that looks good and conveys the meaning of your plot.</p>
<ul>
<li><strong>Try changing the values of <code>binwidth</code> and <code>bins</code> below to see what works best.</strong></li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="index.html#cb16-1" tabindex="-1"></a><span class="co"># adjust width of each bar</span></span>
<span id="cb16-2"><a href="index.html#cb16-2" tabindex="-1"></a><span class="fu">ggplot</span>(ratings, <span class="fu">aes</span>(<span class="at">x =</span> viewers_7day)) <span class="sc">+</span></span>
<span id="cb16-3"><a href="index.html#cb16-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">2</span>)</span>
<span id="cb16-4"><a href="index.html#cb16-4" tabindex="-1"></a><span class="co"># adjust number of bars</span></span>
<span id="cb16-5"><a href="index.html#cb16-5" tabindex="-1"></a><span class="fu">ggplot</span>(ratings, <span class="fu">aes</span>(<span class="at">x =</span> viewers_7day)) <span class="sc">+</span></span>
<span id="cb16-6"><a href="index.html#cb16-6" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">5</span>)</span></code></pre></div>
<p>Finally, the default style of grey bars is a bit boring, so you can change that by setting the <code>fill</code> and <code>colour</code>, as well as using <code>scale_x_continuous()</code> to update the axis labels.</p>
<ul>
<li><strong>Adapt and run this code to control the appearance of the histogram</strong></li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="index.html#cb17-1" tabindex="-1"></a><span class="fu">ggplot</span>(ratings, <span class="fu">aes</span>(<span class="at">x =</span> viewers_7day)) <span class="sc">+</span></span>
<span id="cb17-2"><a href="index.html#cb17-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, </span>
<span id="cb17-3"><a href="index.html#cb17-3" tabindex="-1"></a>                 <span class="at">boundary =</span> <span class="dv">0</span>, </span>
<span id="cb17-4"><a href="index.html#cb17-4" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb17-5"><a href="index.html#cb17-5" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-6"><a href="index.html#cb17-6" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Number of viewers 7 days after broadcast (in millions)&quot;</span>)</span></code></pre></div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="index.html#cb18-1" tabindex="-1"></a><span class="fu">ggplot</span>(ratings, <span class="fu">aes</span>(<span class="at">x =</span> viewers_7day)) <span class="sc">+</span></span>
<span id="cb18-2"><a href="index.html#cb18-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, </span>
<span id="cb18-3"><a href="index.html#cb18-3" tabindex="-1"></a>                 <span class="at">boundary =</span> <span class="dv">0</span>, </span>
<span id="cb18-4"><a href="index.html#cb18-4" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>,   <span class="co"># Can change the colour here for the bars</span></span>
<span id="cb18-5"><a href="index.html#cb18-5" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> <span class="co"># Can change the colour of the outline of the bars</span></span>
<span id="cb18-6"><a href="index.html#cb18-6" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Number of viewers 7 days after broadcast (in millions)&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="grouped-numerical-variables" class="section level2 hasAnchor" number="1.6">
<h2><span class="header-section-number">1.6</span> Grouped numerical variables<a href="index.html#grouped-numerical-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are several ways to compare numerical data across groups. Which you choose depends on what point you are trying to make with the plot.</p>
<div id="subdividing-distributions" class="section level3 hasAnchor" number="1.6.1">
<h3><span class="header-section-number">1.6.1</span> Subdividing distributions<a href="index.html#subdividing-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In previous plots, we have used <code>fill</code> purely for visual reasons, e.g., we have changed the colour of the histogram bars to make them look nicer. However, you can also use <code>fill</code> to represent another variable so that the colours become meaningful.</p>
<p>Setting the <code>fill</code> aesthetic in the mapping will produce different coloured bars for each category of the <code>fill</code> variable, in this case <code>issue_category</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="index.html#cb19-1" tabindex="-1"></a><span class="fu">ggplot</span>(ratings, <span class="fu">aes</span>(<span class="at">x =</span> viewers_7day, <span class="at">fill =</span> channel)) <span class="sc">+</span></span>
<span id="cb19-2"><a href="index.html#cb19-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>,</span>
<span id="cb19-3"><a href="index.html#cb19-3" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-15"></span>
<img src="main_files/figure-html/unnamed-chunk-15-1.png" alt="Histogram with categories represented by fill." width="672" />
<p class="caption">
Figure 1.3: Histogram with categories represented by fill.
</p>
</div>
</div>
<div id="violin-plot" class="section level3 hasAnchor" number="1.6.2">
<h3><span class="header-section-number">1.6.2</span> Violin plot<a href="index.html#violin-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another way to compare groups of continuous variables is the violin plot. This is like a density plot, but rotated 90 degrees and mirrored - the fatter the violin, the larger proportion of data points there are at that value.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="index.html#cb20-1" tabindex="-1"></a>  <span class="fu">ggplot</span>(ratings, <span class="fu">aes</span>(<span class="at">x =</span> channel, <span class="at">y =</span> viewers_7day)) <span class="sc">+</span></span>
<span id="cb20-2"><a href="index.html#cb20-2" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb20-3"><a href="index.html#cb20-3" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;scale = &quot;area&quot;&#39;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:violin-plot"></span>
<img src="main_files/figure-html/violin-plot-1.png" alt="The default violin plot gives each shape the same area. Set scale='count' to make the size proportional to the number of observations." width="768" />
<p class="caption">
Figure 1.4: The default violin plot gives each shape the same area. Set scale='count' to make the size proportional to the number of observations.
</p>
</div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="index.html#cb21-1" tabindex="-1"></a>  <span class="fu">ggplot</span>(ratings, <span class="fu">aes</span>(<span class="at">x =</span> channel, <span class="at">y =</span> viewers_7day)) <span class="sc">+</span></span>
<span id="cb21-2"><a href="index.html#cb21-2" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">scale =</span> <span class="st">&quot;count&quot;</span>) <span class="sc">+</span></span>
<span id="cb21-3"><a href="index.html#cb21-3" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;scale = &quot;count&quot;&#39;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-16-1.png" width="768" /></p>
</div>
<div id="boxplot" class="section level3 hasAnchor" number="1.6.3">
<h3><span class="header-section-number">1.6.3</span> Boxplot<a href="index.html#boxplot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Boxplots serve a similar purpose to violin plots. They don't show you the shape of the distribution, but rather some statistics about it. The middle line represents the median; half the data are above this line and half below it. The box encloses the 25th to 75th percentiles of the data, so 50% of the data falls inside the box. The "whiskers" extending above and below the box extend 1.5 times the height of the box, although you can change this with the <code>coef</code> argument. The points show outliers -- individual data points that fall outside of this range.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="index.html#cb22-1" tabindex="-1"></a>  <span class="fu">ggplot</span>(ratings, <span class="fu">aes</span>(<span class="at">x =</span> channel, <span class="at">y =</span> viewers_7day)) <span class="sc">+</span></span>
<span id="cb22-2"><a href="index.html#cb22-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:box-plot"></span>
<img src="main_files/figure-html/box-plot-1.png" alt="Basic boxplot." width="672" />
<p class="caption">
Figure 1.5: Basic boxplot.
</p>
</div>
<p> 
 </p>
</div>
<div id="test-your-understanding-1" class="section level3 hasAnchor" number="1.6.4">
<h3><span class="header-section-number">1.6.4</span> Test your understanding<a href="index.html#test-your-understanding-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="main_files/figure-html/test-grouped-continuous-1.png" width="672" /><img src="main_files/figure-html/test-grouped-continuous-2.png" width="672" /></p>
<ul>
<li>How would you create plot A? <select class='webex-select'><option value='blank'></option><option value='x'>geom_box()</option><option value='x'>geom_boxplot()</option><option value='answer'>geom_violin()</option><option value='x'>geom_violinplot()</option></select></li>
<li>How would you create plot B? <select class='webex-select'><option value='blank'></option><option value='x'>geom_box()</option><option value='answer'>geom_boxplot()</option><option value='x'>geom_violin()</option><option value='x'>geom_violinplot()</option></select></li>
<li>What does the mapping look like for both plots?
<div id="radio_IPPBVFYBQY" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_IPPBVFYBQY" value="x"></input> <span>aes(x = series, y = viewers_7day, fill = viewers_7day)</span></label><label><input type="radio" autocomplete="off" name="radio_IPPBVFYBQY" value="x"></input> <span>aes(x = series, y = viewers_7day, colour = viewers_7day)</span></label><label><input type="radio" autocomplete="off" name="radio_IPPBVFYBQY" value="answer"></input> <span>aes(x = series, y = viewers_7day, fill = series)</span></label><label><input type="radio" autocomplete="off" name="radio_IPPBVFYBQY" value="x"></input> <span>aes(x = series, y = viewers_7day, colour = series)</span></label>
</div></li>
<li>Which series had the highest ratings? <select class='webex-select'><option value='blank'></option><option value='NA'>1</option><option value='NA'>2</option><option value='NA'>3</option><option value='NA'>4</option><option value='NA'>5</option><option value='NA'>6</option><option value='answer'>7</option><option value='NA'>8</option><option value='NA'>9</option><option value='NA'>10</option></select></li>
<li>Which channel brodcast the series with the highest ratings? (You need to think back to answer this question) <select class='webex-select'><option value='blank'></option><option value='answer'>BBC 1</option><option value='NA'>BBC 2</option><option value='NA'>Channel 4</option></select></li>
</ul>
</div>
</div>
<div id="two-numerical-variables" class="section level2 hasAnchor" number="1.7">
<h2><span class="header-section-number">1.7</span> Two numerical variables<a href="index.html#two-numerical-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When you want to see how two numerical variables are related, set one as the x-axis and the other as the y-axis. For example, what if we want to see the changes in ratings over the episodes/series in chronological order.</p>
<div id="scatterplot" class="section level3 hasAnchor" number="1.7.1">
<h3><span class="header-section-number">1.7.1</span> Scatterplot<a href="index.html#scatterplot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The function to create a scatterplot is called <code>geom_point()</code>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="index.html#cb23-1" tabindex="-1"></a><span class="fu">ggplot</span>(ratings, <span class="fu">aes</span>(<span class="at">x =</span> ep_id, <span class="at">y =</span> viewers_7day)) <span class="sc">+</span></span>
<span id="cb23-2"><a href="index.html#cb23-2" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:demo-point"></span>
<img src="main_files/figure-html/demo-point-1.png" alt="Scatterplot with geom_point()." width="672" />
<p class="caption">
Figure 1.6: Scatterplot with geom_point().
</p>
</div>
<ul>
<li><strong>Edit and run the above code to join up the points in the scatterplot by adding the function <code>+ geom_line</code> and then modify the code further to remove the points</strong></li>
</ul>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="index.html#cb24-1" tabindex="-1"></a><span class="fu">ggplot</span>(ratings, <span class="fu">aes</span>(<span class="at">x =</span> ep_id, <span class="at">y =</span> viewers_7day)) <span class="sc">+</span></span>
<span id="cb24-2"><a href="index.html#cb24-2" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb24-3"><a href="index.html#cb24-3" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb24-4"><a href="index.html#cb24-4" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Scatterplot with both points and lines&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/demo-line-1.png" width="672" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="index.html#cb25-1" tabindex="-1"></a><span class="fu">ggplot</span>(ratings, <span class="fu">aes</span>(<span class="at">x =</span> ep_id, <span class="at">y =</span> viewers_7day)) <span class="sc">+</span></span>
<span id="cb25-2"><a href="index.html#cb25-2" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb25-3"><a href="index.html#cb25-3" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Scatterplot with just lines&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/demo-line-2.png" width="672" /></p>
</div>
<p>These plots show each individual episodes' ratings and are perhaps more detailed than we need. If we were just interested in looking at the ratings across series, then we could create summaries for each series and plot these.</p>
<ul>
<li><strong>Examine and run this code to produce a lineplot of the average ratings for each series</strong></li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="index.html#cb26-1" tabindex="-1"></a>avg_ratings <span class="ot">&lt;-</span> ratings <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="index.html#cb26-2" tabindex="-1"></a>  <span class="fu">select</span>(series, episode, viewers_7day) <span class="sc">%&gt;%</span> </span>
<span id="cb26-3"><a href="index.html#cb26-3" tabindex="-1"></a>  <span class="fu">group_by</span>(series) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="index.html#cb26-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_viewers_7day =</span> <span class="fu">mean</span>(viewers_7day)) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="index.html#cb26-5" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb26-6"><a href="index.html#cb26-6" tabindex="-1"></a></span>
<span id="cb26-7"><a href="index.html#cb26-7" tabindex="-1"></a><span class="fu">ggplot</span>(avg_ratings, <span class="fu">aes</span>(<span class="at">x =</span> series, <span class="at">y =</span> avg_viewers_7day, <span class="at">group=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb26-8"><a href="index.html#cb26-8" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb26-9"><a href="index.html#cb26-9" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb26-10"><a href="index.html#cb26-10" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Great British Bake Off Average Ratings&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<div class="webex-solution">
<button>
Optional: Why do we need group=1
</button>
<p>Because the <code>x</code> values in <code>aes()</code> are a factor, by default <code>geom_line()</code> treats each unique <code>x</code> value as a separate group and tries to connect points only inside each group. Setting <code>group=1</code> in <code>aes()</code> ensures that all values are treated as one group (and therefore connected by lines using <code>geom_line()</code>).</p>
</div>
<p> </p>
</div>
</div>
<div id="two-numerical-variables-and-a-categorical-variable" class="section level2 hasAnchor" number="1.8">
<h2><span class="header-section-number">1.8</span> Two numerical variables and a categorical variable<a href="index.html#two-numerical-variables-and-a-categorical-variable" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It is often the case that we are interested in relationships between more then two variables.</p>
<p>The code below illustrates how to build more complex graphical summaries, in this case number of viewers of the first and last episode in each series.</p>
<ul>
<li><strong>You do not need to produce this plot but have a look and see if you can follow the code that is used to create it.</strong></li>
</ul>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="index.html#cb27-1" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> ratings <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="index.html#cb27-2" tabindex="-1"></a>  <span class="fu">select</span>(series, episode, viewers_7day) <span class="sc">%&gt;%</span> </span>
<span id="cb27-3"><a href="index.html#cb27-3" tabindex="-1"></a>  <span class="fu">group_by</span>(series) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="index.html#cb27-4" tabindex="-1"></a>  <span class="fu">filter</span>(episode <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> episode <span class="sc">==</span> <span class="fu">max</span>(<span class="fu">as.numeric</span>(episode))) <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="index.html#cb27-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">episode =</span> <span class="fu">recode</span>(episode, <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;first&quot;</span>, <span class="at">.default =</span> <span class="st">&quot;last&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-6"><a href="index.html#cb27-6" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb27-7"><a href="index.html#cb27-7" tabindex="-1"></a></span>
<span id="cb27-8"><a href="index.html#cb27-8" tabindex="-1"></a><span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> series,</span>
<span id="cb27-9"><a href="index.html#cb27-9" tabindex="-1"></a>                      <span class="at">y =</span> viewers_7day,</span>
<span id="cb27-10"><a href="index.html#cb27-10" tabindex="-1"></a>                      <span class="at">color =</span> episode, </span>
<span id="cb27-11"><a href="index.html#cb27-11" tabindex="-1"></a>                      <span class="at">group =</span> episode</span>
<span id="cb27-12"><a href="index.html#cb27-12" tabindex="-1"></a>                      )) <span class="sc">+</span></span>
<span id="cb27-13"><a href="index.html#cb27-13" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb27-14"><a href="index.html#cb27-14" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb27-15"><a href="index.html#cb27-15" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Great British Bake Off Finales Get More Viewers than Premiers&quot;</span>) <span class="sc">+</span></span>
<span id="cb27-16"><a href="index.html#cb27-16" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;Episode&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>

</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>

<a href="group-exercises.html" class="navigation navigation-next navigation-unique" aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["main.pdf", "main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"info": true
});
});
</script>

</body>

</html>
